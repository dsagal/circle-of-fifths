!function(t){var e={};function n(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(s,i,function(e){return t[e]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=n(1),i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],r=[1,0,1,0,1,1,0,1,0,1,0,1];function o(t,e=.8){return p(t.map((n,i)=>{const r=2*Math.PI*i/t.length;return s.dom.update(t[i],s.dom.style("top",50*(1-Math.cos(r)*e)+"%"),s.dom.style("left",50*(1+Math.sin(r)*e)+"%"))}))}function u(t,e,n,i){const r=e.getBoundingClientRect(),o=r.left+r.width/2,u=r.top+r.height/2,d=Math.atan2(t.clientY-u,t.clientX-o);if(isNaN(d))return;const l=n.get()-d,a=s.dom.onElem(document,"mouseup",(function(t){h.dispose(),a.dispose(),function(t){const e=2*Math.PI/12;i(p?c(Math.PI/2+Math.round(d/e)*e,n.get()):Math.round(n.get()/e)*e)}()}),{useCapture:!0}),h=s.dom.onElem(document,"mousemove",(function(t){p=!1;let e=Math.atan2(t.clientY-u,t.clientX-o);if(isNaN(e))return;n.set(c(l+e,n.get()))}),{useCapture:!0});let p=!0;t.preventDefault()}function c(t,e){return t+2*Math.round((e-t)/(2*Math.PI))*Math.PI}const d=s.styled("div","\n  box-sizing: border-box;\n  font-family: sans-serif;\n  position: relative;\n  margin: 40px;\n  --overlay-color: rgba(230, 200, 250);\n  display: flex;\n  flex-wrap: wrap;\n  align-items: top;\n\n  *, *:before, *:after {\n  -webkit-box-sizing: border-box;\n     -moz-box-sizing: border-box;\n          box-sizing: border-box;\n  }\n"),l=s.styled("div","\n  margin-right: 40px;\n"),a=s.styled("div","\n  margin: 20px;\n  text-align: center;\n  font-size: larger;\n"),h=s.styled("div","\n  position: relative;\n"),p=s.styled("div","\n  position: relative;\n  width: 360px;\n  height: 360px;\n  border-radius: 360px;\n  border: 1px solid lightgrey;\n"),f=s.styled("div","\n  position: absolute;\n  border-radius: 48px;\n  border: 1px solid grey;\n  width: 48px;\n  height: 48px;\n  margin-left: -24px;\n  margin-top: -24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"),_=s.styled("div","\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  border-radius: 100%;\n  box-shadow: inset 0 0 0 12px var(--overlay-color);\n  overflow: hidden;\n  opacity: 0.8;\n  transition: transform 0.15s;\n  cursor: grab;\n"),m=s.styled("div","\n  position: absolute;\n  top: calc(180px - 110px);\n  left: calc(180px - 110px);\n  width: 220px;\n  height: 220px;\n  border-radius: 100%;\n  background-color: var(--overlay-color);\n"),g=s.styled("div","\n  position: absolute;\n  border-radius: 48px;\n  border: 1px solid grey;\n  width: 48px;\n  height: 48px;\n  margin-left: -24px;\n  margin-top: -24px;\n  box-shadow: 0 0 0 24px var(--overlay-color);\n  &-close {\n    background-color: var(--overlay-color);\n  }\n  &-major-start {\n    border: 3px solid red;\n  }\n  &-minor-start {\n    border: 3px solid blue;\n  }\n  &-legend {\n    position: relative;\n    margin: 0 16px 0 0;\n    box-shadow: none;\n  }\n"),b=s.styled("div","\n  margin: 40px;\n"),y=s.styled("div","\n  padding: 8px;\n  display: flex;\n  align-items: center;\n");s.dom.update(document.body,function(){const t=s.Observable.create(null,0),e=s.Observable.create(null,0);function n(n){t.set(n),e.set(c(7*n,e.get()))}function p(n){e.set(n),t.set(c(7*n,t.get()))}function w(t){return 7*t%12}return d(l(a("Half-Tones in Order"),h(o(i.map((t,e)=>f(t))),s.dom.update(o(r.map((t,e)=>g(g.cls("-close",!t),g.cls("-major-start",0==e),g.cls("-minor-start",9==e)))),_.cls(""),m(),s.dom.style("transform",e=>`rotate(${e(t)}rad)`),s.dom.on("mousedown",(e,s)=>u(e,s,t,n))))),l(a("Circle of Fifths"),h(o(i.map((t,e)=>f(i[w(e)]))),s.dom.update(o(r.map((t,e)=>{const n=w(e);return g(g.cls("-close",!r[n]),g.cls("-major-start",0==n),g.cls("-minor-start",9==n))})),_.cls(""),m(),s.dom.style("transform",t=>`rotate(${t(e)}rad)`),s.dom.on("mousedown",(t,n)=>u(t,n,e,p))))),b(y(g(g.cls("-major-start"),g.cls("-legend")),s.dom("div","First note of the Major scale")),y(g(g.cls("-minor-start"),g.cls("-legend")),s.dom("div","First note of the Minor scale"))))}())},function(t,e,n){"use strict";function s(){}n.r(e),n.d(e,"subscribeBindable",(function(){return G})),n.d(e,"subscribeElem",(function(){return X})),n.d(e,"Computed",(function(){return U})),n.d(e,"computed",(function(){return V})),n.d(e,"Disposable",(function(){return d})),n.d(e,"Holder",(function(){return l})),n.d(e,"MultiHolder",(function(){return a})),n.d(e,"setDisposeOwner",(function(){return h})),n.d(e,"svg",(function(){return At})),n.d(e,"update",(function(){return Ot})),n.d(e,"frag",(function(){return Bt})),n.d(e,"find",(function(){return jt})),n.d(e,"findAll",(function(){return Pt})),n.d(e,"create",(function(){return qt})),n.d(e,"replaceContent",(function(){return Tt})),n.d(e,"domComputed",(function(){return Wt})),n.d(e,"maybe",(function(){return Ft})),n.d(e,"_disposeNode",(function(){return L})),n.d(e,"domDisposeHooks",(function(){return I})),n.d(e,"domDispose",(function(){return O})),n.d(e,"onDisposeElem",(function(){return S})),n.d(e,"onDispose",(function(){return N})),n.d(e,"autoDisposeElem",(function(){return M})),n.d(e,"autoDispose",(function(){return B})),n.d(e,"forEach",(function(){return Xt})),n.d(e,"attrsElem",(function(){return tt})),n.d(e,"attrs",(function(){return et})),n.d(e,"attrElem",(function(){return nt})),n.d(e,"attr",(function(){return st})),n.d(e,"boolAttrElem",(function(){return it})),n.d(e,"boolAttr",(function(){return rt})),n.d(e,"textElem",(function(){return ot})),n.d(e,"text",(function(){return ut})),n.d(e,"styleElem",(function(){return ct})),n.d(e,"style",(function(){return dt})),n.d(e,"propElem",(function(){return lt})),n.d(e,"prop",(function(){return at})),n.d(e,"showElem",(function(){return ht})),n.d(e,"show",(function(){return pt})),n.d(e,"hideElem",(function(){return ft})),n.d(e,"hide",(function(){return _t})),n.d(e,"clsElem",(function(){return mt})),n.d(e,"cls",(function(){return gt})),n.d(e,"clsPrefix",(function(){return bt})),n.d(e,"dataElem",(function(){return wt})),n.d(e,"data",(function(){return vt})),n.d(e,"getData",(function(){return xt})),n.d(e,"makeTestId",(function(){return Ct})),n.d(e,"noTestId",(function(){return Dt})),n.d(e,"onElem",(function(){return Qt})),n.d(e,"on",(function(){return Zt})),n.d(e,"onMatchElem",(function(){return te})),n.d(e,"onMatch",(function(){return ee})),n.d(e,"onKeyElem",(function(){return ne})),n.d(e,"onKeyPress",(function(){return se})),n.d(e,"onKeyDown",(function(){return ie})),n.d(e,"dom",(function(){return re})),n.d(e,"LLink",(function(){return i})),n.d(e,"Emitter",(function(){return r})),n.d(e,"Listener",(function(){return o})),n.d(e,"fromKo",(function(){return T})),n.d(e,"KoWrapObs",(function(){return W})),n.d(e,"toKo",(function(){return K})),n.d(e,"setupKoDisposal",(function(){return q})),n.d(e,"ObsArray",(function(){return zt})),n.d(e,"MutableObsArray",(function(){return $t})),n.d(e,"obsArray",(function(){return Rt})),n.d(e,"ComputedArray",(function(){return Ht})),n.d(e,"computedArray",(function(){return Ut})),n.d(e,"makeLiveIndex",(function(){return Vt})),n.d(e,"LiveIndex",(function(){return Gt})),n.d(e,"bundleChanges",(function(){return x})),n.d(e,"BaseObservable",(function(){return C})),n.d(e,"Observable",(function(){return D})),n.d(e,"observable",(function(){return E})),n.d(e,"obsHolder",(function(){return A})),n.d(e,"PureComputed",(function(){return le})),n.d(e,"pureComputed",(function(){return ae})),n.d(e,"styled",(function(){return he})),n.d(e,"keyframes",(function(){return pe})),n.d(e,"Subscription",(function(){return $})),n.d(e,"subscribe",(function(){return R})),n.d(e,"bindB",(function(){return ge})),n.d(e,"bindUB",(function(){return be})),n.d(e,"bindBU",(function(){return ye})),n.d(e,"input",(function(){return we})),n.d(e,"select",(function(){return Ce}));class i{constructor(){this._next=null,this._prev=null,this._next=this,this._prev=this}isDisposed(){return!this._next}_insertBefore(t,e){const n=t._prev;n._next=e,t._prev=e,e._prev=n,e._next=t}_removeNode(t){t._prev&&(t._prev._next=t._next,t._next._prev=t._prev),t._prev=t._next=null}_disposeList(){let t=this,e=t._next;for(;null!==e;)t._next=t._prev=null,t=e,e=t._next}}class r extends i{constructor(){super(),this._changeCB=s,this._changeCBContext=void 0}addListener(t,e){return new o(this,t,e)}emit(...t){o.callAll(this._next,this,t)}setChangeCB(t,e){this._changeCB=t||s,this._changeCBContext=e}_triggerChangeCB(){this._changeCB.call(this._changeCBContext,this.hasListeners())}hasListeners(){return this._next!==this}dispose(){this._disposeList(),this._changeCB=s,this._changeCBContext=void 0}}class o extends i{constructor(t,e,n){super(),this.emitter=t,this.callback=e,this.context=n,this._insertBefore(t,this),t._triggerChangeCB()}static callAll(t,e,n){for(;t!==e;){const e=t;e.callback.call(e.context,...n),t=e._next}}dispose(){this.isDisposed()||(this._removeNode(this),this.emitter._triggerChangeCB())}}const u={autoDispose(t){}};let c=u;class d{constructor(){this._disposalList=new f,c.autoDispose(this),c=u}static create(t,...e){const n=c,s=new l;try{return c=s,h(t,new this(...e))}catch(t){try{s.clear()}catch(t){console.error("Error disposing partially constructed %s:",this.name,t)}throw t}finally{s.release(),c=n}}autoDispose(t){return this.onDispose(t.dispose,t),t}onDispose(t,e){return this._disposalList.addListener(t,e)}wipeOnDispose(){this.onDispose(this._wipeOutObject,this)}isDisposed(){return null===this._disposalList}dispose(){const t=this._disposalList;t?(this._disposalList=null,t.callAndDispose(this)):console.error("Error disposing %s which is already disposed",p(this))}_wipeOutObject(){for(const t of Object.keys(this))this[t]=null}}class l{constructor(){this._owned=null,this._disposalListener=void 0}static create(t){return h(t,new l)}autoDispose(t){return this.clear(),this._owned=t,t instanceof d&&(this._disposalListener=t.onDispose(this._onOutsideDispose,this)),t}release(){this._unlisten();const t=this._owned;return this._owned=null,t}clear(){this._unlisten();const t=this._owned;t&&(this._owned=null,t.dispose())}get(){return this._owned}isEmpty(){return!this._owned}dispose(){this.clear()}_unlisten(){const t=this._disposalListener;t&&(this._disposalListener=void 0,t.dispose())}_onOutsideDispose(){this._disposalListener=void 0,this._owned=null}}class a extends d{}function h(t,e){return t&&t.autoDispose(e),e}function p(t){return t&&t.constructor&&t.constructor.name?t.constructor.name:""+t}class f extends i{constructor(){super()}addListener(t,e){const n=new _(t,e);return this._insertBefore(this._next,n),n}callAndDispose(t){try{_.callAll(this._next,this,t)}finally{this._disposeList()}}}class _ extends i{constructor(t,e){super(),this.callback=t,this.context=e}static callAll(t,e,n){for(;t!==e;){const e=t;try{e.callback.call(e.context)}catch(t){console.error("While disposing %s, error disposing %s: %s",p(n),p(this),t)}t=e._next}}dispose(){this.isDisposed()||this._removeNode(this)}}class m{constructor(t,e){this._priority=0,this._enqueued=!1,this._creation=++b,this._callback=t,this._context=e}static isPrioritySmaller(t,e){return t._priority<e._priority||t._priority===e._priority&&t._creation<e._creation}useDep(t){const e=t?t._priority:0;e>=this._priority&&(this._priority=e+1)}recompute(){this._priority=0,this._callback.call(this._context)}enqueue(){this._enqueued||(this._enqueued=!0,g.push(this))}}const g=new class{constructor(t){this._isPrior=t,this._items=[]}get size(){return this._items.length}push(t){const e=this._items,n=this._isPrior;let s=this._items.length;for(;s>0;){const i=s-1>>1,r=e[i];if(n(r,t))break;e[s]=r,s=i}e[s]=t}peek(){return this._items[0]}pop(){if(this._items.length<=1)return this._items.pop();const t=this._items,e=this._isPrior,n=t[0],s=t.pop(),i=this._items.length;let r=0,o=1;for(;o<i;){const n=o+1,u=n<i&&e(t[n],t[o])?n:o;if(e(s,t[u]))break;t[r]=t[u],r=u,o=r+r+1}return t[r]=s,n}}(m.isPrioritySmaller);let b=0;const y=[];let w=0;function v(){if(0===w&&g.size>0){w++;try{do{const t=g.pop();y.push(t),t.recompute()}while(g.size>0)}finally{for(const t of y)t._enqueued=!1;y.length=0,w--}}}function x(t){try{return w++,t()}finally{w--,v()}}class C{constructor(t){this._onChange=new r,this._value=t}get(){return this._value}set(t){t!==this._value&&this.setAndTrigger(t)}setAndTrigger(t){const e=this._value;this._value=t,this._onChange.emit(t,e),this._disposeOwned(),v()}addListener(t,e){return this._onChange.addListener(t,e)}hasListeners(){return this._onChange.hasListeners()}setListenerChangeCB(t,e){this._onChange.setChangeCB(t,e)}_getDepItem(){return null}dispose(){this._disposeOwned(),this._onChange.dispose(),this._value=void 0}isDisposed(){return this._onChange.isDisposed()}_disposeOwned(t){}_setWithArg(t,e){const n=this._value;this._value=t,this._onChange.emit(t,n,e),this._disposeOwned(e),v()}}class D extends C{constructor(){super(...arguments),this._owned=void 0}static holder(t){const e=new D(t);return e._owned=t,e}static create(t,e){return h(t,new D(e))}autoDispose(t){return this.setAndTrigger(t),this._owned=t,t}_disposeOwned(){this._owned&&(this._owned.dispose(),this._owned=void 0)}}function E(t){return new D(t)}function A(t){return D.holder(t)}const k=new WeakMap;function L(t){let e=k.get(t);if(e){let n=t;do{k.delete(n),e(t),n=e,e=k.get(n)}while(e)}}const I={disposeNode:L,disposeRecursive:function(t){!function t(e,n){let s=e.firstChild;for(;s;)t(s,n),s=s.nextSibling;n(e)}(t,I.disposeNode)}};function O(t){I.disposeRecursive(t)}function S(t,e){const n=k.get(t);k.set(t,e),n&&k.set(e,n)}function N(t){return e=>S(e,t)}function M(t,e){e&&S(t,()=>e.dispose())}function B(t){if(t)return e=>M(e,t)}const j=new WeakMap,P=new WeakMap;function T(t){return j.get(t)||j.set(t,new W(t)).get(t)}class W extends D{constructor(t){super(t.peek()),this._koObs=t,this._koSub=null,this.setListenerChangeCB(t=>{t?this._koSub||(this._value=this._koObs.peek(),this._koSub=this._koObs.subscribe(t=>this.setAndTrigger(t))):(this._koSub.dispose(),this._koSub=null)})}get(){return this._koObs.peek()}set(t){x(()=>this._koObs(t))}dispose(){throw new Error("KoWrapObs should not be disposed")}}function K(t,e){const n=P.get(e);if(n)return n;const s=t.observable(e.get());return P.set(e,s),e.addListener(t=>s(t)),s}let F=!1;function q(t){if(F)return;F=!0;const e=t.utils.domNodeDisposal,n=e.cleanExternalData,s=I.disposeRecursive;function i(t){n(t),I.disposeNode(t)}e.cleanExternalData=i,I.disposeRecursive=function(r){s(r),e.cleanExternalData=n;try{t.cleanNode(r)}finally{e.cleanExternalData=i}}}const z=[];class ${constructor(t,e,n){this._depItem=new m(this._evaluate,this),this._dependencies=e.length>0?e:z,this._depListeners=e.length>0?e.map(t=>this._subscribeTo(t)):z,this._dynDeps=new Map,this._callback=t,this._useFunc=this._useDependency.bind(this),n&&(this._useFunc.owner=n),this._evaluate()}dispose(){this._callback=null;for(const t of this._depListeners)t.dispose();for(const t of this._dynDeps.values())t.dispose()}_getDepItem(){return this._depItem}_useDependency(t){const e="_getDepItem"in t?t:T(t);let n=this._dynDeps.get(e);return n||(n=this._subscribeTo(e),this._dynDeps.set(e,n)),n._inUse=!0,this._depItem.useDep(e._getDepItem()),e.get()}_evaluate(){if(null!==this._callback)try{const t=[this._useFunc];for(let e=0,n=this._dependencies.length;e<n;e++)t[e+1]=this._dependencies[e].get(),this._depItem.useDep(this._dependencies[e]._getDepItem());return this._callback.apply(void 0,t)}finally{this._dynDeps.forEach((t,e)=>{t._inUse?t._inUse=!1:(this._dynDeps.delete(e),t.dispose())})}}_subscribeTo(t){return("_getDepItem"in t?t:T(t)).addListener(this._enqueue,this)}_enqueue(){this._depItem.enqueue()}}function R(...t){const e=t.pop();return new $(e,t)}function H(){throw new Error("Can't write to non-writable computed")}class U extends D{constructor(t,e){super(void 0),this._callback=t,this._write=H,this._sub=new $(this._read.bind(this),e,this)}static create(t,...e){const n=e.pop();return h(t,new U(n,e))}_getDepItem(){return this._sub._getDepItem()}set(t){this._write(t)}onWrite(t){return this._write=t,this}dispose(){this._sub.dispose(),super.dispose()}_read(t,...e){super.set(this._callback(t,...e))}}function V(...t){const e=t.pop();return new U(e,t)}function G(t,e){if("function"==typeof t){const n=t;if("function"==typeof n.peek){const t=n.subscribe(t=>e(t));return e(n.peek()),t}const s=V(t);return s.addListener(t=>e(t)),e(s.get()),s}return t instanceof C?R(t,(t,n)=>e(n)):(e(t),null)}function X(t,e,n){M(t,G(e,n))}function Y(t,e){t.DocumentFragment=e.DocumentFragment,t.Element=e.Element,t.Node=e.Node,t.document=e.document,t.window=e.window}const J={};Y(J,"undefined"!=typeof window?window:{});const Q=Object.assign({},J);const Z=new WeakMap;function tt(t,e){for(const n of Object.keys(e)){const s=e[n];null!=s&&!1!==s&&t.setAttribute(n,!0===s?"":s)}}function et(t){return e=>tt(e,t)}function nt(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function st(t,e){return n=>X(n,e,e=>nt(n,t,e))}function it(t,e,n){nt(t,e,n?"":null)}function rt(t,e){return n=>X(n,e,e=>it(n,t,e))}function ot(t,e){t.appendChild(Q.document.createTextNode(e))}function ut(t){return e=>{const n=Q.document.createTextNode("");X(e,t,t=>{n.nodeValue=t}),e.appendChild(n)}}function ct(t,e,n){t.style[e]=n}function dt(t,e){return n=>X(n,e,e=>ct(n,t,e))}function lt(t,e,n){t[e]=n}function at(t,e){return n=>X(n,e,e=>lt(n,t,e))}function ht(t,e){t.style.display=e?"":"none"}function pt(t){return e=>X(e,t,t=>ht(e,t))}function ft(t,e){t.style.display=e?"none":""}function _t(t){return e=>X(e,t,t=>ft(e,t))}function mt(t,e,n=!0){t.classList.toggle(e,Boolean(n))}function gt(t,e){return"string"!=typeof t?yt("",t):e&&"boolean"!=typeof e?n=>X(n,e,e=>mt(n,t,e)):n=>mt(n,t,e)}function bt(t,e,n){return"string"!=typeof e?yt(t,e):gt(t+e,n)}function yt(t,e){return n=>{let s=null;X(n,e,e=>{s&&n.classList.remove(s),s=e?t+e:null,s&&n.classList.add(s)})}}function wt(t,e,n){const s=Z.get(t);s?s[e]=n:(S(t,()=>Z.delete(t)),Z.set(t,{[e]:n}))}function vt(t,e){return n=>X(n,e,e=>wt(n,t,e))}function xt(t,e){const n=Z.get(t);return n&&n[e]}function Ct(t){return bt.bind(null,t)}const Dt=t=>null;function Et(t,...e){return Nt(It(kt,t),e)}function At(t,...e){return Nt(It(Lt,t),e)}function kt(t){return Q.document.createElement(t)}function Lt(t){return Q.document.createElementNS("http://www.w3.org/2000/svg",t)}function It(t,e){let n,s,i,r=e.indexOf(".");const o=e.indexOf("#");if(-1===r?r=e.length:i=e.substring(r+1).replace(/\./g," "),-1===o)n=e.substring(0,r);else{if(o>r)throw new Error(`ID must come before classes in dom("${e}")`);n=e.substring(0,o),s=e.substring(o+1,r)}const u=t(n);return s&&u.setAttribute("id",s),i&&u.setAttribute("class",i),u}function Ot(t,...e){return St(t,e)}function St(t,e){for(const n of e)Mt(t,n);return t}function Nt(t,e){try{return St(t,e)}catch(e){throw O(t),e}}function Mt(t,e){if("function"==typeof e){const n=e(t);null!=n&&Mt(t,n)}else Array.isArray(e)?St(t,e):null==e||(e instanceof Q.Node?t.appendChild(e):"object"==typeof e?tt(t,e):t.appendChild(Q.document.createTextNode(e)))}function Bt(...t){return Nt(Q.document.createDocumentFragment(),t)}function jt(t){return Q.document.querySelector(t)}function Pt(t){return Q.document.querySelectorAll(t)}function Tt(t,e,n){const s=t.parentNode;if(s){let i;for(let n=t.nextSibling;n&&n!==e;n=i)i=n.nextSibling,O(n),s.removeChild(n);n&&s.insertBefore(n instanceof Q.Node?n:Bt(n),e)}}function Wt(t,e=Kt){const n=Q.document.createComment("a"),s=Q.document.createComment("b");return[n,s,i=>{X(s,t,t=>Tt(n,s,e(t)))}]}function Kt(t){return t}function Ft(t,e){return Wt(t,t=>t?e(t):null)}function qt(t,...e){const[n,s,i]=Wt(null,()=>{const n=a.create(null);M(s,n);const i="create"in t?t.create(n,...e):t(n,...e);return i&&"object"==typeof i&&"buildDom"in i?i.buildDom():i});return[n,s,i]}class zt extends C{constructor(){super(...arguments),this._ownedItems=void 0}addListener(t,e){return super.addListener(t,e)}autoDispose(t){return this._ownedItems||(this._ownedItems=new Set),this._ownedItems.add(t),t}dispose(){if(this._ownedItems){for(const t of this.get())this._ownedItems.delete(t)&&t.dispose();this._ownedItems=void 0}super.dispose()}_setWithSplice(t,e){return this._setWithArg(t,e)}_disposeOwned(t){if(this._ownedItems)if(t)for(const e of t.deleted)this._ownedItems.delete(e)&&e.dispose();else{const t=this._ownedItems;this._ownedItems=new Set;for(const e of this.get())t.delete(e)&&this._ownedItems.add(e);for(const e of t)e.dispose()}}}class $t extends zt{push(...t){const e=this.get(),n=e.length,s=e.push(...t);return this._setWithSplice(e,{start:n,numAdded:t.length,deleted:[]}),s}pop(){const t=this.get();if(0===t.length)return;const e=t.pop();return this._setWithSplice(t,{start:t.length,numAdded:0,deleted:[e]}),e}unshift(...t){const e=this.get(),n=e.unshift(...t);return this._setWithSplice(e,{start:0,numAdded:t.length,deleted:[]}),n}shift(){const t=this.get();if(0===t.length)return;const e=t.shift();return this._setWithSplice(t,{start:0,numAdded:0,deleted:[e]}),e}splice(t,e=1/0,...n){const s=this.get(),i=s.length;t=Math.min(i,Math.max(0,t<0?i+t:t));const r=s.splice(t,e,...n);return this._setWithSplice(s,{start:t,numAdded:n.length,deleted:r}),r}}function Rt(t=[]){return new $t(t)}class Ht extends zt{constructor(t,e){var n;super([]),this._mapper=e,this._sub=(n=t,Array.isArray(n.get())?R(t,e=>this._syncMap(t)):R(t,(t,e)=>(t(e),this._syncMap(e))))}dispose(){this._unsync(),this._sub.dispose(),super.dispose()}_syncMap(t){this._source!==t?(this._unsync(),this._listener=t.addListener(this._recordChange,this),this._source=t,this._rebuild(t)):this._lastSplice?this._applySplice(t,this._lastSplice):this._rebuild(t),this._lastSplice=void 0}_unsync(){this._listener&&(this._listener.dispose(),this._listener=void 0,this._source=void 0)}_rebuild(t){this.set(t.get().map((t,e)=>this._mapper.call(void 0,t,e,this)))}_applySplice(t,e){const n=t.get(),s=[];for(let t=e.start,i=0;i<e.numAdded;t++,i++)s.push(this._mapper.call(void 0,n[t],t,this));const i=this.get(),r=i.splice(e.start,e.deleted.length,...s);this._setWithSplice(i,{start:e.start,numAdded:s.length,deleted:r})}_recordChange(t,e,n){n&&void 0===this._lastSplice?this._lastSplice=n:this._lastSplice=!1}}function Ut(t,e){return new Ht(t,e)}function Vt(t,e,n=0){return h(t,new Gt(e,n))}class Gt extends D{constructor(t,e=0){super(null),this._obsArray=t,this._isLive=!0,this.set(e),this._listener=t.addListener(this._onArrayChange,this)}set(t){const e=this._obsArray.get().length;super.set(0===e?null:Math.max(0,Math.min(e-1,t||0)))}setLive(t){this._isLive=t}dispose(){this._listener.dispose(),super.dispose()}_onArrayChange(t,e,n){const s=this.get();this.set(null!==s&&n?this._isLive&&s>=n.start+n.deleted.length?s+n.numAdded-n.deleted.length:this._isLive&&s>=n.start+n.numAdded?n.start+n.numAdded:s:0)}}function Xt(t,e){return n=>{const s=Q.document.createComment("a"),i=Q.document.createComment("b");if(n.appendChild(s),n.appendChild(i),Array.isArray(t))return void Tt(s,i,t.map(e));const r=Ut(t,e);M(i,r),r.addListener((t,e,r)=>{if(r){for(const t of r.deleted)t&&t.parentNode===n&&(O(t),n.removeChild(t));if(r.numAdded>0){const e=r.start+r.numAdded;let s=i;for(let i=e;i<t.length;i++){const e=t[i];if(e&&e.parentNode===n){s=e;break}}const o=Bt(t.slice(r.start,e));n.insertBefore(o,s)}}else Tt(s,i,t)}),Tt(s,i,r.get())}}class Yt{constructor(t,e,n,s,i){this.elem=t,this.eventType=e,this.callback=n,this.useCapture=s,this.selector=i,this.elem.addEventListener(this.eventType,this,this.useCapture)}handleEvent(t){(0,this.callback)(t,this.elem)}dispose(){this.elem.removeEventListener(this.eventType,this,this.useCapture)}}class Jt extends Yt{handleEvent(t){const e=function(t,e,n){for(let s=t;s&&s!==e;s=s.parentElement)if(s.matches(n))return s;return null}(t.target,this.elem,this.selector);if(e){(0,this.callback)(t,e)}}}function Qt(t,e,n,{useCapture:s=!1}={}){return new Yt(t,e,n,s)}function Zt(t,e,{useCapture:n=!1}={}){return s=>{new Yt(s,t,e,n)}}function te(t,e,n,s,{useCapture:i=!1}={}){return new Jt(t,n,s,i,e)}function ee(t,e,n,{useCapture:s=!1}={}){return i=>{new Jt(i,e,n,s,t)}}function ne(t,e,n){return t.tabIndex>=0||t.setAttribute("tabindex","-1"),Qt(t,e,(t,e)=>{const s=n[t.key],i=s||n[t.key+"$"];i&&(s&&(t.stopPropagation(),t.preventDefault()),i(t,e))})}function se(t){return e=>{ne(e,"keypress",t)}}function ie(t){return e=>{ne(e,"keydown",t)}}function re(t,...e){return Et(t,...e)}var oe;function ue(){throw new Error("Can't write to non-writable pureComputed")}function ce(t){return"get"in t?t.get():t.peek()}(oe=re||(re={})).svg=At,oe.frag=Bt,oe.update=Ot,oe.find=jt,oe.findAll=Pt,oe.domDispose=O,oe.onDisposeElem=S,oe.onDispose=N,oe.autoDisposeElem=M,oe.autoDispose=B,oe.attrsElem=tt,oe.attrs=et,oe.attrElem=nt,oe.attr=st,oe.boolAttrElem=it,oe.boolAttr=rt,oe.textElem=ot,oe.text=ut,oe.styleElem=ct,oe.style=dt,oe.propElem=lt,oe.prop=at,oe.showElem=ht,oe.show=pt,oe.hideElem=ft,oe.hide=_t,oe.clsElem=mt,oe.cls=gt,oe.clsPrefix=bt,oe.dataElem=wt,oe.data=vt,oe.getData=xt,oe.replaceContent=Tt,oe.domComputed=Wt,oe.maybe=Ft,oe.forEach=Xt,oe.create=qt,oe.onElem=Qt,oe.on=Zt,oe.onMatchElem=te,oe.onMatch=ee,oe.onKeyElem=ne,oe.onKeyPress=se,oe.onKeyDown=ie;const de=[];class le extends D{constructor(t,e){super(void 0),this._callback=t,this._write=ue,this._dependencies=e.length>0?e:de,this._sub=null,this._inCall=!1,this.setListenerChangeCB(this._onListenerChange,this)}_getDepItem(){return this._activate(),this._sub._getDepItem()}get(){if(!this._sub&&!this._inCall){this._inCall=!0;try{const t=[ce];for(let e=0,n=this._dependencies.length;e<n;e++)t[e+1]=this._dependencies[e].get();super.set(this._callback.apply(void 0,t))}finally{this._inCall=!1}}return super.get()}set(t){this._write(t)}onWrite(t){return this._write=t,this}dispose(){this._sub&&this._sub.dispose(),this._sub=!0,super.dispose()}_activate(){this._sub||(this._sub=new $(this._read.bind(this),this._dependencies))}_onListenerChange(t){t?this._activate():this._sub&&(this._sub.dispose(),this._sub=null)}_read(t,...e){super.set(this._callback(t,...e))}}function ae(...t){const e=t.pop();return new le(e,t)}function he(t,e){const n=new _e(e),s="string"==typeof t?(...e)=>n.addToElem(Et(t,...e)):(...e)=>n.addToElem(t(...e));return Object.assign(s,{className:n.className,cls:bt.bind(null,n.className)})}function pe(t){return new me(t).className}const fe={};class _e{constructor(t){this._styles=t,this._mounted=!1,this.className=_e._nextClassName(),_e._unmounted.add(this)}static _nextClassName(){return`_grain${function(){const t=Q.window||fe;return t._grainNextStyleNum=(t._grainNextStyleNum||0)+1}()}_`}static _mountAll(){const t=Array.from(this._unmounted,t=>t._createRules()).join("\n\n");Q.document.head.appendChild(Et("style",t));for(const t of this._unmounted)t._mounted=!0;this._unmounted.clear()}addToElem(t){return this._mounted||_e._mountAll(),t.classList.add(this.className),t}_createRules(){return function(t,e){const n=e.search(/[^;]*\{/);return`& {${n<0?e:e.slice(0,n)}\n}\n${n<0?"":e.slice(n)}`.replace(/&/g,t)}("."+this.className,this._styles)}}_e._unmounted=new Set;class me extends _e{_createRules(){return`@keyframes ${this.className} {${this._styles}}`}}function ge(t,e){switch(e.length){case 0:return()=>t();case 1:return()=>t(e[0]);case 2:return()=>t(e[0],e[1]);case 3:return()=>t(e[0],e[1],e[2]);case 4:return()=>t(e[0],e[1],e[2],e[3]);case 5:return()=>t(e[0],e[1],e[2],e[3],e[4]);case 6:return()=>t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return()=>t(e[0],e[1],e[2],e[3],e[4],e[5],e[6]);case 8:return()=>t(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);default:return()=>t.apply(void 0,e)}}function be(t,e){switch(e.length){case 0:return e=>t(e);case 1:return n=>t(n,e[0]);case 2:return n=>t(n,e[0],e[1]);case 3:return n=>t(n,e[0],e[1],e[2]);case 4:return n=>t(n,e[0],e[1],e[2],e[3]);case 5:return n=>t(n,e[0],e[1],e[2],e[3],e[4]);case 6:return n=>t(n,e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return n=>t(n,e[0],e[1],e[2],e[3],e[4],e[5],e[6]);case 8:return n=>t(n,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);default:return n=>t(n,...e)}}function ye(t,e){switch(e.length){case 0:return e=>t(e);case 1:return n=>t(e[0],n);case 2:return n=>t(e[0],e[1],n);case 3:return n=>t(e[0],e[1],e[2],n);case 4:return n=>t(e[0],e[1],e[2],e[3],n);case 5:return n=>t(e[0],e[1],e[2],e[3],e[4],n);case 6:return n=>t(e[0],e[1],e[2],e[3],e[4],e[5],n);case 7:return n=>t(e[0],e[1],e[2],e[3],e[4],e[5],e[6],n);case 8:return n=>t(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],n);default:return n=>t(...e,n)}}function we(t,e,...n){const s=e.isValid;function i(e){x(()=>{t.set(e.value),s&&s.set(e.validity.valid)})}return re("input",...n,re.prop("value",t),s?e=>re.autoDisposeElem(e,R(t,t=>s.set(e.checkValidity()))):null,e.onInput?re.on("input",(t,e)=>i(e)):null,re.on("change",(t,e)=>i(e)),re.onKeyPress({Enter:(t,e)=>i(e)}))}function ve(t){return Array.isArray(t)?t:t.get()}function xe(t){return"string"==typeof t?t:t.value}function Ce(t,e,n={}){const{defLabel:s=""}=n;return re("select",re("option",re.hide(!0),s),re.forEach(e,e=>{const n="string"==typeof e?{value:e,label:e}:e;return re("option",{disabled:n.disabled,selected:n.value===t.get()},n.label)}),n=>re.autoDisposeElem(n,R(t,(t,s)=>{const i=ve(e).findIndex(t=>xe(t)===s);n.selectedIndex=i+1})),re.on("change",(n,s)=>{const i=s.selectedIndex,r=ve(e)[i-1];void 0!==r&&t.set(xe(r))}))}}]);
//# sourceMappingURL=index.js.map